---
title: "data_analysis_project"
output: html_notebook
---
#Loading Libraries
```{r}
library(tidyverse)
library(sf)
library(janitor)
library(tidycensus)
library(tigris)
library(lubridate)
census_api_key("ab0ed8418e6554d3eb77ed342784e3bb0b002a64")#, install=TRUE)
```

#Loading Data
```{r}
census_data <- read_csv("census_incarceration.csv")
```

#Clean Data
```{r}
clean_counties <-census_data %>% 
  filter(state != "PR", state != "AK")
```

#National Rates
```{r}
rates <- clean_counties %>%
  summarise( 
    state= "US",
    rate_20 = sum(incarcerated_20)/sum(total_population_20)*100,
    rate_10 = sum(incarcerated_10)/sum(total_population_10)*100,
    rate_00 = sum(incarcerated_00)/sum(total_population_00)*100,
    rank_20 = NA,
    rank_10 = NA,
    rank_00 = NA
             ) 
```



#Question 1: How do individual state incarceration rates compare to the national average?
There are 22 states that are above the national average incarceration rates, which makes sense because it is the states that make up the national average and we're looking at 49 states so half of 49 is 24.5 which is just slightly above 22. This also tells me that there are states pulling the the national rate up because the average is above the median of the states.

#Question 2: Are there any states consistently below the national average, possibly dragging it down each year? Are there any states consistently above the national average?
Over the past 20 years, West Virginia has jumped from 28 to 2. What is driving these higher incarceration rates? Could it be that 20 years ago West Virginia was a democratic state? We can tell that over time the consistently high incarceration states are states run by Republicans? Is there a reason for this from certain laws? In 2000, West Virginia narrowly supported George Bush over Al Gore but that was the turning point, before that their electoral votes were for Democrats. After 2000, they're one of the most Republican states. If you look at Georgia, which voted Democrat for president in 2020 for the first time since 1992 (for Bill Clinton), has been falling in the ranks of incarceration rates since 2000. They've dropped from 3 to 7 over 20 years. 

Over the past 20 years, Louisiana has been in the top 2. In 2000, they were ranked 2nd and in 2010 and 2020 they were ranked 1st. 

Republican states have tended to increase in incarceration ranking over the last 20 years, for example Mississippi (5->3), Arkansas (12->5), Kentucky(16->9), Alabama(14->10), South Dakota (26->11), New Mexico (25->12), Indiana (33->20), Idaho (31-22). Interestingly, over time Democratic states have fallen in the rankings: Virginia (6->15), Delaware (13->31), Maryland (19->35), Connecticut (27->38), New York (35->44). Could this be because there are states that ship their incarcerated people to other states (maybe states with high property values ship their incarcerated people to states with low property value because thats where it's cheaper to build prisons)?

#Question 3: Have any state’s average population increased while incarceration rates didn't?

#Question 4: Are there any counties driving a state's incarceration rate?
Yes, in West Virginia there are counties 37 counties that in at least one of the years reported 0 incarcerations. This is extremely strange because West Virginia has been one of the highest ranked states by incarceration. This means that there are specific counties within the state that are driving the incarceration rate upwards. This is demonstrated by the fact that in certain counties, like Gilmer and Doddrige, the incarceration rate is almost 20% of the total population. This is even more interesting because in both of those counties in 2000, 0% of the population of those counties was incarcerated. 

In certain counties, like Crowley County, CO, 48% of the population is incarcerated. The population of Crowley is 5,000 and the size of the prison is 2,000 people. Is this because it's a small county with a huge prison and we are counting the prisoners as people living the county and not being shipped from other counties?

```{r}
wv_zoom<-clean_counties %>% 
  filter(state=="WV") %>% 
  mutate(
    rate_20 = (incarcerated_20)/(total_population_20)*100,
    rate_10 = (incarcerated_10)/(total_population_10)*100,
    rate_00 = (incarcerated_00)/(total_population_00)*100)
wv_zoom %>% pivot_longer(starts_with("inc"),values_to = "cnt",names_to = "year") %>% select(state,county,year,cnt)
wv_zoom %>% filter(incarcerated_20==0 | incarcerated_10==0 | incarcerated_00==0)
##  count(incarcerated_pop_00==0, incarcerated_pop_10==0, incarcerated_pop_20 == 0)
```


#Question 5: How does incarceration rates over the years compare to population rates?

#Question 6: Why do some counties have zero people incarcerated and do we think it’s accurate?
After a little bit of research, Nantucket, which is one of the counties that reports having 0 people incarcerated, "does not have a facility on Nantucket for holding prisoners."
(https://www.muckrock.com/foi/nantucket-214/jail-deaths-2020-21-nantucket-county-sheriffs-department-119440/#file-973814)


#Other Notes

Prisons and the census - https://www.prisonersofthecensus.org/faq.html#:~:text=A%3A%20The%20Census%20justifies%20counting,special%20populations%20in%20the%20past.

Look up:
Laws that have increased prison populations in Republican states

Incentives: Federal Funding and the prison boom: https://www.brennancenter.org/issues/end-mass-incarceration/changing-incentives

Economics of Incarceration - https://www.prisonpolicy.org/research/economics_of_incarceration/

Conservatism and Crimial Justice Reform - https://www.theguardian.com/us-news/2018/aug/05/the-conservative-case-for-criminal-justice-reform





```{r}
state_rates <-clean_counties %>% 
  group_by(state) %>% 
  summarise(
    rate_20 = sum(incarcerated_20)/sum(total_population_20)*100,
    rate_10 = sum(incarcerated_10)/sum(total_population_10)*100,
    rate_00 = sum(incarcerated_00)/sum(total_population_00)*100) %>%
  mutate(
    rank_20 = min_rank(-rate_20),
    rank_10 = min_rank(-rate_10),
    rank_00 = min_rank(-rate_00)) %>% 
  bind_rows(rates) %>%
  arrange(desc(rate_20))
```

```{r}
state_rates %>% 
  ggplot(aes(rate_20))+ geom_histogram(bins = 20)+geom_vline(xintercept = rates$rate_20) +
  geom_label(aes(y=8,label=state))
 
```


```{r}
counties_with_zero<-clean_counties %>% 
  arrange(incarcerated_20 + incarcerated_10 + incarcerated_20)
```
```{r}
allcounty_rates<-clean_counties %>% 
  mutate(rate_20=incarcerated_20/total_population_20*100,
         rate_10=incarcerated_10/total_population_10*100,
         rate_00=incarcerated_00/total_population_00*100) %>% 
  arrange(-rate_20) %>% select (state,county,rate_20:rate_00)
```




```{r}
#states
alabama <- census_data %>% 
  filter(state == 'AL')

#no alaska

arizona <- census_data %>% 
  filter(state == 'AZ')

arkansas <- census_data %>% 
  filter(state == 'AR')

california <- census_data %>% 
  filter(state == 'CA')

colorado <- census_data %>% 
  filter(state == 'CO')

connecticut <- census_data %>% 
  filter(state == 'CT')

delaware <- census_data %>% 
  filter(state == 'DE')

district_of_columbia <- census_data %>% 
  filter(state == 'DC')

florida <- census_data %>% 
  filter(state == 'FL')

georgia <- census_data %>% 
  filter(state == 'GA')

hawaii <- census_data %>% 
  filter(state == 'HI')

idaho <- census_data %>% 
  filter(state == 'ID')

illinois <- census_data %>% 
  filter(state == 'IL')

indiana <- census_data %>% 
  filter(state == 'IN')

iowa <- census_data %>% 
  filter(state == 'IA')

kansas <- census_data %>% 
  filter(state == 'KS')

kentucky <- census_data %>% 
  filter(state == 'KY')

louisiana <- census_data %>% 
  filter(state == 'LA')

maine <- census_data %>% 
  filter(state == 'ME')

maryland <- census_data %>% 
  filter(state == 'MD')

massachusetts <- census_data %>% 
  filter(state == 'MS')

michigan <- census_data %>% 
  filter(state == 'MI')

minnesota <- census_data %>% 
  filter(state == 'MN')

mississippi <- census_data %>% 
  filter(state == 'MS')

missouri <- census_data %>% 
  filter(state == 'MO')

montana <- census_data %>% 
  filter(state == 'MT')

nebraska <- census_data %>% 
  filter(state == 'NE')

nevada <- census_data %>% 
  filter(state == 'NV')

new_hampshire <- census_data %>% 
  filter(state == 'NH')

new_jersey <- census_data %>% 
  filter(state == 'NJ')

new_mexico <- census_data %>% 
  filter(state == 'NM')

new_york <- census_data %>% 
  filter(state == 'NY')

north_carolina <- census_data %>% 
  filter(state == 'NC')

north_dakota <- census_data %>% 
  filter(state == 'ND')

ohio <- census_data %>% 
  filter(state == 'OH')

oklahoma <- census_data %>% 
  filter(state == 'OK')

oregon <- census_data %>% 
  filter(state == 'OR')

pennsylvania <- census_data %>% 
  filter(state == 'PA')

rhode_island <- census_data %>% 
  filter(state == 'RI')

south_carolina <- census_data %>% 
  filter(state == 'SC')

south_dakota <- census_data %>% 
  filter(state == 'SD')

tennessee <- census_data %>% 
  filter(state == 'TN')

texas <- census_data %>% 
  filter(state == 'TX')

utah <- census_data %>% 
  filter(state == 'UT')

vermont <- census_data %>% 
  filter(state == 'VT')

virginia <- census_data %>% 
  filter(state == 'VA')

washington_state <- census_data %>% 
  filter(state == 'WA')

west_virginia <- census_data %>% 
  filter(state == 'WV')

wisconsin <- census_data %>% 
  filter(state == 'WI')

wyoming <- census_data %>% 
  filter(state == 'WY')
```

```{r}
#states totaled up
alabama_totals <- alabama %>% 
  summarise(
    total_population_20 = sum(total_population_20),
    incarcerated_20 = sum(incarcerated_20),
    total_population_10 = sum(total_population_10),
    incarcerated_10 = sum(incarcerated_10),
    total_population_00 = sum(total_population_00),
    incarcerated_00 = sum(incarcerated_00)
  )

#no alaska

arizona_totals <- arizona %>% 
summarise(
    total_population_20 = sum(total_population_20),
    incarcerated_20 = sum(incarcerated_20),
    total_population_10 = sum(total_population_10),
    incarcerated_10 = sum(incarcerated_10),
    total_population_00 = sum(total_population_00),
    incarcerated_00 = sum(incarcerated_00))

arkansas_totals <- arkansas %>% 
summarise(
    total_population_20 = sum(total_population_20),
    incarcerated_20 = sum(incarcerated_20),
    total_population_10 = sum(total_population_10),
    incarcerated_10 = sum(incarcerated_10),
    total_population_00 = sum(total_population_00),
    incarcerated_00 = sum(incarcerated_00))

california_totals <- california %>% 
summarise(
    total_population_20 = sum(total_population_20),
    incarcerated_20 = sum(incarcerated_20),
    total_population_10 = sum(total_population_10),
    incarcerated_10 = sum(incarcerated_10),
    total_population_00 = sum(total_population_00),
    incarcerated_00 = sum(incarcerated_00))

colorado_totals <- colorado %>% 
summarise(
    total_population_20 = sum(total_population_20),
    incarcerated_20 = sum(incarcerated_20),
    total_population_10 = sum(total_population_10),
    incarcerated_10 = sum(incarcerated_10),
    total_population_00 = sum(total_population_00),
    incarcerated_00 = sum(incarcerated_00))


connecticut_totals <- connecticut %>% 
summarise(
    total_population_20 = sum(total_population_20),
    incarcerated_20 = sum(incarcerated_20),
    total_population_10 = sum(total_population_10),
    incarcerated_10 = sum(incarcerated_10),
    total_population_00 = sum(total_population_00),
    incarcerated_00 = sum(incarcerated_00))


delaware_totals <- delaware %>% 
summarise(
    total_population_20 = sum(total_population_20),
    incarcerated_20 = sum(incarcerated_20),
    total_population_10 = sum(total_population_10),
    incarcerated_10 = sum(incarcerated_10),
    total_population_00 = sum(total_population_00),
    incarcerated_00 = sum(incarcerated_00))


district_of_columbia_totals <- district_of_columbia %>% 
summarise(
    total_population_20 = sum(total_population_20),
    incarcerated_20 = sum(incarcerated_20),
    total_population_10 = sum(total_population_10),
    incarcerated_10 = sum(incarcerated_10),
    total_population_00 = sum(total_population_00),
    incarcerated_00 = sum(incarcerated_00))


florida_totals <- florida %>% 
summarise(
    total_population_20 = sum(total_population_20),
    incarcerated_20 = sum(incarcerated_20),
    total_population_10 = sum(total_population_10),
    incarcerated_10 = sum(incarcerated_10),
    total_population_00 = sum(total_population_00),
    incarcerated_00 = sum(incarcerated_00))


georgia_totals <- georgia %>% 
summarise(
    total_population_20 = sum(total_population_20),
    incarcerated_20 = sum(incarcerated_20),
    total_population_10 = sum(total_population_10),
    incarcerated_10 = sum(incarcerated_10),
    total_population_00 = sum(total_population_00),
    incarcerated_00 = sum(incarcerated_00))


hawaii_totals <- hawaii %>% 
summarise(
    total_population_20 = sum(total_population_20),
    incarcerated_20 = sum(incarcerated_20),
    total_population_10 = sum(total_population_10),
    incarcerated_10 = sum(incarcerated_10),
    total_population_00 = sum(total_population_00),
    incarcerated_00 = sum(incarcerated_00))


idaho_totals <- idaho %>% 
summarise(
    total_population_20 = sum(total_population_20),
    incarcerated_20 = sum(incarcerated_20),
    total_population_10 = sum(total_population_10),
    incarcerated_10 = sum(incarcerated_10),
    total_population_00 = sum(total_population_00),
    incarcerated_00 = sum(incarcerated_00))


illinois_totals <- illinois %>% 
summarise(
    total_population_20 = sum(total_population_20),
    incarcerated_20 = sum(incarcerated_20),
    total_population_10 = sum(total_population_10),
    incarcerated_10 = sum(incarcerated_10),
    total_population_00 = sum(total_population_00),
    incarcerated_00 = sum(incarcerated_00))


indiana_totals <- indiana %>% 
summarise(
    total_population_20 = sum(total_population_20),
    incarcerated_20 = sum(incarcerated_20),
    total_population_10 = sum(total_population_10),
    incarcerated_10 = sum(incarcerated_10),
    total_population_00 = sum(total_population_00),
    incarcerated_00 = sum(incarcerated_00))


iowa_totals <- iowa %>% 
summarise(
    total_population_20 = sum(total_population_20),
    incarcerated_20 = sum(incarcerated_20),
    total_population_10 = sum(total_population_10),
    incarcerated_10 = sum(incarcerated_10),
    total_population_00 = sum(total_population_00),
    incarcerated_00 = sum(incarcerated_00))


kansas_totals <- kansas %>% 
summarise(
    total_population_20 = sum(total_population_20),
    incarcerated_20 = sum(incarcerated_20),
    total_population_10 = sum(total_population_10),
    incarcerated_10 = sum(incarcerated_10),
    total_population_00 = sum(total_population_00),
    incarcerated_00 = sum(incarcerated_00))


kentucky_totals <- kentucky %>% 
summarise(
    total_population_20 = sum(total_population_20),
    incarcerated_20 = sum(incarcerated_20),
    total_population_10 = sum(total_population_10),
    incarcerated_10 = sum(incarcerated_10),
    total_population_00 = sum(total_population_00),
    incarcerated_00 = sum(incarcerated_00))


louisiana_totals <- louisiana %>% 
summarise(
    total_population_20 = sum(total_population_20),
    incarcerated_20 = sum(incarcerated_20),
    total_population_10 = sum(total_population_10),
    incarcerated_10 = sum(incarcerated_10),
    total_population_00 = sum(total_population_00),
    incarcerated_00 = sum(incarcerated_00))


maine_totals <- maine %>% 
summarise(
    total_population_20 = sum(total_population_20),
    incarcerated_20 = sum(incarcerated_20),
    total_population_10 = sum(total_population_10),
    incarcerated_10 = sum(incarcerated_10),
    total_population_00 = sum(total_population_00),
    incarcerated_00 = sum(incarcerated_00))


maryland_totals <- maryland %>% 
summarise(
    total_population_20 = sum(total_population_20),
    incarcerated_20 = sum(incarcerated_20),
    total_population_10 = sum(total_population_10),
    incarcerated_10 = sum(incarcerated_10),
    total_population_00 = sum(total_population_00),
    incarcerated_00 = sum(incarcerated_00))


massachusetts_totals <- massachusetts %>% 
summarise(
    total_population_20 = sum(total_population_20),
    incarcerated_20 = sum(incarcerated_20),
    total_population_10 = sum(total_population_10),
    incarcerated_10 = sum(incarcerated_10),
    total_population_00 = sum(total_population_00),
    incarcerated_00 = sum(incarcerated_00))


michigan_totals <- michigan %>% 
summarise(
    total_population_20 = sum(total_population_20),
    incarcerated_20 = sum(incarcerated_20),
    total_population_10 = sum(total_population_10),
    incarcerated_10 = sum(incarcerated_10),
    total_population_00 = sum(total_population_00),
    incarcerated_00 = sum(incarcerated_00))


minnesota_totals <- minnesota %>% 
summarise(
    total_population_20 = sum(total_population_20),
    incarcerated_20 = sum(incarcerated_20),
    total_population_10 = sum(total_population_10),
    incarcerated_10 = sum(incarcerated_10),
    total_population_00 = sum(total_population_00),
    incarcerated_00 = sum(incarcerated_00))


mississippi_totals <- mississippi %>% 
summarise(
    total_population_20 = sum(total_population_20),
    incarcerated_20 = sum(incarcerated_20),
    total_population_10 = sum(total_population_10),
    incarcerated_10 = sum(incarcerated_10),
    total_population_00 = sum(total_population_00),
    incarcerated_00 = sum(incarcerated_00))


missouri_totals <- missouri %>% 
summarise(
    total_population_20 = sum(total_population_20),
    incarcerated_20 = sum(incarcerated_20),
    total_population_10 = sum(total_population_10),
    incarcerated_10 = sum(incarcerated_10),
    total_population_00 = sum(total_population_00),
    incarcerated_00 = sum(incarcerated_00))


montana_totals <- montana %>% 
summarise(
    total_population_20 = sum(total_population_20),
    incarcerated_20 = sum(incarcerated_20),
    total_population_10 = sum(total_population_10),
    incarcerated_10 = sum(incarcerated_10),
    total_population_00 = sum(total_population_00),
    incarcerated_00 = sum(incarcerated_00))


nebraska_totals <- nebraska %>% 
summarise(
    total_population_20 = sum(total_population_20),
    incarcerated_20 = sum(incarcerated_20),
    total_population_10 = sum(total_population_10),
    incarcerated_10 = sum(incarcerated_10),
    total_population_00 = sum(total_population_00),
    incarcerated_00 = sum(incarcerated_00))


nevada_totals <- nevada %>% 
summarise(
    total_population_20 = sum(total_population_20),
    incarcerated_20 = sum(incarcerated_20),
    total_population_10 = sum(total_population_10),
    incarcerated_10 = sum(incarcerated_10),
    total_population_00 = sum(total_population_00),
    incarcerated_00 = sum(incarcerated_00))


new_hampshire_totals <- new_hampshire %>% 
summarise(
    total_population_20 = sum(total_population_20),
    incarcerated_20 = sum(incarcerated_20),
    total_population_10 = sum(total_population_10),
    incarcerated_10 = sum(incarcerated_10),
    total_population_00 = sum(total_population_00),
    incarcerated_00 = sum(incarcerated_00))


new_jersey_totals <- new_jersey %>% 
summarise(
    total_population_20 = sum(total_population_20),
    incarcerated_20 = sum(incarcerated_20),
    total_population_10 = sum(total_population_10),
    incarcerated_10 = sum(incarcerated_10),
    total_population_00 = sum(total_population_00),
    incarcerated_00 = sum(incarcerated_00))


new_mexico_totals <- new_mexico %>% 
summarise(
    total_population_20 = sum(total_population_20),
    incarcerated_20 = sum(incarcerated_20),
    total_population_10 = sum(total_population_10),
    incarcerated_10 = sum(incarcerated_10),
    total_population_00 = sum(total_population_00),
    incarcerated_00 = sum(incarcerated_00))


new_york_totals <- new_york %>% 
summarise(
    total_population_20 = sum(total_population_20),
    incarcerated_20 = sum(incarcerated_20),
    total_population_10 = sum(total_population_10),
    incarcerated_10 = sum(incarcerated_10),
    total_population_00 = sum(total_population_00),
    incarcerated_00 = sum(incarcerated_00))


north_carolina_totals <- north_carolina %>% 
summarise(
    total_population_20 = sum(total_population_20),
    incarcerated_20 = sum(incarcerated_20),
    total_population_10 = sum(total_population_10),
    incarcerated_10 = sum(incarcerated_10),
    total_population_00 = sum(total_population_00),
    incarcerated_00 = sum(incarcerated_00))


north_dakota_totals <- north_dakota %>% 
summarise(
    total_population_20 = sum(total_population_20),
    incarcerated_20 = sum(incarcerated_20),
    total_population_10 = sum(total_population_10),
    incarcerated_10 = sum(incarcerated_10),
    total_population_00 = sum(total_population_00),
    incarcerated_00 = sum(incarcerated_00))


ohio_totals <- ohio %>% 
summarise(
    total_population_20 = sum(total_population_20),
    incarcerated_20 = sum(incarcerated_20),
    total_population_10 = sum(total_population_10),
    incarcerated_10 = sum(incarcerated_10),
    total_population_00 = sum(total_population_00),
    incarcerated_00 = sum(incarcerated_00))


oklahoma_totals <- oklahoma %>% 
summarise(
    total_population_20 = sum(total_population_20),
    incarcerated_20 = sum(incarcerated_20),
    total_population_10 = sum(total_population_10),
    incarcerated_10 = sum(incarcerated_10),
    total_population_00 = sum(total_population_00),
    incarcerated_00 = sum(incarcerated_00))


oregon_totals <- oregon %>% 
summarise(
    total_population_20 = sum(total_population_20),
    incarcerated_20 = sum(incarcerated_20),
    total_population_10 = sum(total_population_10),
    incarcerated_10 = sum(incarcerated_10),
    total_population_00 = sum(total_population_00),
    incarcerated_00 = sum(incarcerated_00))


pennsylvania_totals <- pennsylvania %>% 
summarise(
    total_population_20 = sum(total_population_20),
    incarcerated_20 = sum(incarcerated_20),
    total_population_10 = sum(total_population_10),
    incarcerated_10 = sum(incarcerated_10),
    total_population_00 = sum(total_population_00),
    incarcerated_00 = sum(incarcerated_00))


rhode_island_totals <- rhode_island %>% 
summarise(
    total_population_20 = sum(total_population_20),
    incarcerated_20 = sum(incarcerated_20),
    total_population_10 = sum(total_population_10),
    incarcerated_10 = sum(incarcerated_10),
    total_population_00 = sum(total_population_00),
    incarcerated_00 = sum(incarcerated_00))


south_carolina_totals <- south_carolina %>% 
summarise(
    total_population_20 = sum(total_population_20),
    incarcerated_20 = sum(incarcerated_20),
    total_population_10 = sum(total_population_10),
    incarcerated_10 = sum(incarcerated_10),
    total_population_00 = sum(total_population_00),
    incarcerated_00 = sum(incarcerated_00))


south_dakota_totals <- south_dakota %>% 
summarise(
    total_population_20 = sum(total_population_20),
    incarcerated_20 = sum(incarcerated_20),
    total_population_10 = sum(total_population_10),
    incarcerated_10 = sum(incarcerated_10),
    total_population_00 = sum(total_population_00),
    incarcerated_00 = sum(incarcerated_00))


tennessee_totals <- tennessee %>% 
summarise(
    total_population_20 = sum(total_population_20),
    incarcerated_20 = sum(incarcerated_20),
    total_population_10 = sum(total_population_10),
    incarcerated_10 = sum(incarcerated_10),
    total_population_00 = sum(total_population_00),
    incarcerated_00 = sum(incarcerated_00))


texas_totals <- texas %>% 
summarise(
    total_population_20 = sum(total_population_20),
    incarcerated_20 = sum(incarcerated_20),
    total_population_10 = sum(total_population_10),
    incarcerated_10 = sum(incarcerated_10),
    total_population_00 = sum(total_population_00),
    incarcerated_00 = sum(incarcerated_00))


utah_totals <- utah %>% 
summarise(
    total_population_20 = sum(total_population_20),
    incarcerated_20 = sum(incarcerated_20),
    total_population_10 = sum(total_population_10),
    incarcerated_10 = sum(incarcerated_10),
    total_population_00 = sum(total_population_00),
    incarcerated_00 = sum(incarcerated_00))


vermont_totals <- vermont %>% 
summarise(
    total_population_20 = sum(total_population_20),
    incarcerated_20 = sum(incarcerated_20),
    total_population_10 = sum(total_population_10),
    incarcerated_10 = sum(incarcerated_10),
    total_population_00 = sum(total_population_00),
    incarcerated_00 = sum(incarcerated_00))


virginia_totals <- virginia %>% 
summarise(
    total_population_20 = sum(total_population_20),
    incarcerated_20 = sum(incarcerated_20),
    total_population_10 = sum(total_population_10),
    incarcerated_10 = sum(incarcerated_10),
    total_population_00 = sum(total_population_00),
    incarcerated_00 = sum(incarcerated_00))


washington_state_totals <- washington_state %>% 
summarise(
    total_population_20 = sum(total_population_20),
    incarcerated_20 = sum(incarcerated_20),
    total_population_10 = sum(total_population_10),
    incarcerated_10 = sum(incarcerated_10),
    total_population_00 = sum(total_population_00),
    incarcerated_00 = sum(incarcerated_00))


west_virginia_totals <- west_virginia %>% 
summarise(
    total_population_20 = sum(total_population_20),
    incarcerated_20 = sum(incarcerated_20),
    total_population_10 = sum(total_population_10),
    incarcerated_10 = sum(incarcerated_10),
    total_population_00 = sum(total_population_00),
    incarcerated_00 = sum(incarcerated_00))


wisconsin_totals <- wisconsin %>% 
summarise(
    total_population_20 = sum(total_population_20),
    incarcerated_20 = sum(incarcerated_20),
    total_population_10 = sum(total_population_10),
    incarcerated_10 = sum(incarcerated_10),
    total_population_00 = sum(total_population_00),
    incarcerated_00 = sum(incarcerated_00))


wyoming_totals <- wyoming %>% 
summarise(
    total_population_20 = sum(total_population_20),
    incarcerated_20 = sum(incarcerated_20),
    total_population_10 = sum(total_population_10),
    incarcerated_10 = sum(incarcerated_10),
    total_population_00 = sum(total_population_00),
    incarcerated_00 = sum(incarcerated_00))


```

#Analysis of the data
The data has 3,211 rows and 9 columns. Each county for every state has the total population and incarcerated population for 2020, 2010 and 2000, and its FIPS code. One issue we may run into is if the information is not accurate. For example, Nantucket County MA, never has anyone incarcerated over the 20 years we are looking at. I find that suspicious. Not only that, a lot of counties have the same issue. In addition, on our data we have 3211 rows describing counties. In the US there are about 3006 counties. The reason we have more is because our data includes Parishes (which are counties in LA), boroughs, some big cities, Puerto Rico's municipios. I sorted and then saved everything that is not a county in the dataframe not_counties. 

```{r}
graph_over_time<-census_data %>% 
  pivot_longer(cols = starts_with("incarcerated"), names_to = "year", values_to = "number") %>% 
  select(state, county, year, number) %>% 
  mutate(sc=paste0(state,county)) %>%
  ggplot()+
  geom_point(aes(x=year, y=number))+
  geom_line(aes(x=year, y=number, group=sc))
```

```{r}
hist_over_time<-census_data %>% 
  pivot_longer(cols = starts_with("incarcerated"), names_to = "year", values_to = "number") %>% 
  select(state, county, year, number) %>% filter(number<6000) %>%
  ggplot(aes(x=number)) + facet_wrap(vars(year),ncol = 2) +
  geom_histogram(binwidth = 100) +ylab("# of counties") + xlab("number of people incarcerated")
hist_over_time

```


```{r}
not_counties <-census_data %>% 
  filter(!grepl("County\\s*$",county))
```

